<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>无量福报积善功德榜</title>
    <link rel="stylesheet" href="/static/pay-styles.css">
    <script defer src="/static/pay-script.js"></script>
</head>
<body>
    <div class="pay-container">

        <div class="amount-section">
            <h2 id="amount-title">金额</h2>
            <div class="amount-input">
                <span>¥</span>
                <input type="number" id="amount" name="amount" placeholder="0.00" step="0.01" min="0.01">
            </div>
            <div class="quick-amounts">
                <div class="quick-amount" data-amount="50">¥50</div>
                <div class="quick-amount" data-amount="100">¥100</div>
                <div class="quick-amount" data-amount="500">¥500</div>
            </div>
        </div>
        
        <div class="blessing-section">
            <button id="toggle-blessing" class="toggle-btn">+ 祝福语（选填）</button>
            <div id="blessing-container" class="blessing-container" style="display: none; margin-top: 15px;">
                <textarea id="blessing" name="blessing" placeholder="请输入您的祝福语（可选，最多50字）"></textarea>
                <div id="blessing-counter">0/50</div>
            </div>
        </div>
        
        <!-- 用户信息显示区域 -->
        <div class="user-info-section">
            <h3>当前用户信息</h3>
            <img id="user-avatar" class="user-avatar" data-src="./static/avatar.jpeg" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23f0f0f0'/%3E%3C/svg%3E" alt="用户头像">
            <div class="user-info-content">
                <div id="user-nickname" class="user-nickname">未授权："匿名施主"</div>
                <div id="unauthorize-link" class="unauthorize-link" style="display: none;">
                    <a href="javascript:void(0);" onclick="cancelAuthorization()">取消授权，变回匿名施主</a>
                </div>
                <div id="user-time" class="user-time">刚刚</div>
            </div>
        </div>

        <!-- 添加隐藏的支付表单，用于302重定向 -->
		<form id="pay-form" action="/api/donate/form" method="POST" style="display: none;">
			<input type="hidden" id="form-amount" name="amount">
			<input type="hidden" id="form-payment" name="payment" value="wechat">
			<input type="hidden" id="form-category" name="category" value="">
			<input type="hidden" id="form-blessing" name="blessing" value="">
			<input type="hidden" id="form-payment-config-id" name="payment_config_id" value="">
		</form>
        
        <button class="submit-btn" id="submit-btn">立即支付</button>
        
        <a href="/" class="back-btn" id="back-to-ranking">查看积善功德榜</a>
    </div>

</body>
</html>